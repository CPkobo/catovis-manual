---
title:  基本の使い方 Word編(2)
lang: ja-JP
sidebar: auto
prev: ./02_vbacore
next: ./04_withls
---

## CATOVIS VBA Core 単独の機能群

CATOVIS VBA Core でWordファイル上で使える機能は、以下の6つです。

1. センテンス単位でのカーソル移動
2. 原文の簡易可視化
3. 機械翻訳の取得（評価版のみ、要登録）
4. 対訳エディタの使用
5. コンテンツコントロールを利用した対訳作成支援
6. 特殊な一括置換
7. 同一センテンスの自動伝播、一括QAなどの作業自動化支援　（開発中）
   
このページでは後半の**5. コンテンツコントロールを利用した対訳作成支援** 以降を紹介します。
前半部分の紹介については[前のページ](./02_vbacore) を参照ください。

## STEP 5 コンテンツコントロールを利用した対訳作成支援

翻訳の工程においては、見直しや校閲も重要な作業です。このとき、ファイルが対訳状態になっていればファイルを複数開くことなく作業ができるため、効率的です。また、翻訳メモリや用語集づくりといった、翻訳管理の面からも、対訳を作成することの重要性はますます高まっています。
CATOVIS VBA Core では翻訳を上書きで進める一方で、対訳として原文を残すことでこれらの作業ニーズに対応しています。

なお、コンテンツコントロールを利用した翻訳は、対訳エディタの使用を前提としています。

::: warning ご注意ください

この機能はまだ途上段階にあります。また、コンテンツコントロールはあまり目にすることが多い機能ではないため、最初のうちは操作ミス等も起こりえます。まずは少量の原稿か、チュートリアル版で試してみることをお勧めします。

:::

### コンテンツコントロールを使用することでできること

コンテンツコントロールを使用することで、主に以下のような機能を実現しています。

- 単一のファイルに原文・訳文を記録 → チェックの効率化
- 対訳の作成（文単位・段落単位）
- 訳抜けの確認
- 原文のテキストで検索
- 原文のテキストでフィルタ
- 機械翻訳への一括変換

また、以下の機能の開発にも活用予定です。

- 数字・用語のQA
- 書式情報の記録

はじめのうちは、少し複雑さを感じるかもしれませんが、ぜひマスターしてみてください。

::: tip

このページの内容を読み飛ばしても、CATOVIS LSとの連携をすることができます。
翻訳メモリを活用した翻訳に興味がある場合、先に[次のページ](./04_withls)に進んでも問題ありません。

:::

### コンテンツコントロールの有効化

コンテンツコントロールによる翻訳を始めるには、まず設定で有効化する必要があります。

CATOVISタブの左側、**Set** のブロックの右下にある小さな三角を押してください。
次のような設定用フォームが表示されます。

このうち、 **Work** のタブを選び、**コンテンツコントロールを使用する** にチェックを入れて、**CONFIRM** ボタンをクリックしてください。
※「設定を外部ファイルに保存」はチェックしたままにすることを推奨します。

これでコンテンツコントロールの使用が有効化されます。

### コンテンツコントロールの使用

これまでと同様に、**次の文を選択** などで翻訳したい文を対訳エディタに表示した状態にします。続けて対訳エディタ上で翻訳を行い、**Alt+Enter** を押して訳文を確定します。

すると、選択していた部分に訳文が入ると同時に、薄い緑色の「コンテンツコントロール（リッチテキスト）」と呼ばれる枠に変わります。この枠には表示されているテキスト（訳文）とは別に原文が記録されており、その一部が左上に小さな文字で表示されています。

原文を改めて確認するには、コンテンツコントロール上で **Alt＋S**と**Alt+↑** を押すか、**Alt+→/←**でコンテンツコントロールに入るようにします。
すると、対訳エディタのタイトル表示が「チェック中」に、原文側テキストボックスの背景色が「緑色」に変わり、原文と訳文がそれぞれ左右に表示されるようになります。
このときに対訳エディタ上で訳文の修正をして確定（**Alt+S**）すると、Wordファイル上の訳文にも修正が反映されます。

### コンテンツコントロールからの対訳表エクスポート

コンテンツコントロールに入れて翻訳をすると、ファイル内に原文と訳文が対応した状態で記録されていることから、簡単に対訳表を作成することができます。

CATOVIS VBA Coreの対訳表エクスポートは、**「文単位」** と **「段落単位」** から選択可能です（既定値は「文単位」）。

対訳表としてエクスポートするには、CATOVISタブの左側、**Set** のブロックの右端にある **Export** ボタンを押します。
実行を確認するメッセージが表示され、「はい」をクリックするとエクスポートが始まります。

実行が完了すると、新規Wordファイルに表組の形で原文と訳文が表示されます。
このWordファイルを任意の名前で保存したり、Excel等に貼り付けることで対訳表が完成します。

#### コンテンツコントロールからの対訳表エクスポート 単位設定の変更

翻訳メモリ等を作成する際は文単位のエクスポートが便利ですが、DTPなど別媒体に移す際は段落単位でエクスポートする方がより便利です。

この設定は設定用フォームの**Word** タブ内、「エクスポート設定」で変更できます。
**「段落ごと」** にチェックを入れて**CONFIRM** を押して、改めて **Export** ボタンを押します。
今度は一段落が一行に対応した対訳表としてエクスポートされます。

### 訳抜けの確認

CATOVIS VBA Core と他のCATツールとの相違として、「必要な部分だけを選択して進めることができる」という点があります。
表組の中の英数字など、明らかに翻訳不要な箇所が固まっていた場合、目視で飛ばしながら作業することができるのです。

これは便利な反面、訳抜けにつながってしまうこともあります。

コンテンツコントロールを利用したCATOVIS VBA Core の翻訳では、コンテンツコントロールに入っている箇所に一括で色を付けることにより、翻訳を飛ばした箇所を見やすくすることができます。

この機能を利用するには、設定用フォームの**Word** タブ内、「エクスポート設定」にある、**「色をつけて確認する」** ボタンをクリックしてください。

確認が完了したら、再度同じく「エクスポート設定」にある、**「色を消す」** ボタンをクリックすると色が消えます。

### 原文のテキストで検索

コンテンツコントロールに原文・訳文を記録していくと、訳文で上書きをした箇所についても原文のテキストで検索することができます。

原文のテキストで検索するには、CATOVISタブのうち、**Terms** のブロックにある **Replace Term** ボタンを押します。
図のようなダイアログが表示されたら、**Source Control** のタブに移動します。
ここで、「原文」欄に検索したいテキストを入れ、**「原文検索」**ボタンを押します。コンテンツコントロールに入っている原文の中から、当該の単語を持つ部分に移動することができます。また、「次へ」をクリックすることで、コンテンツコントロール間の移動が可能です。

### 原文のテキストでフィルタ

前項の検索は、原文自体は表示しないため、長い原文であったり頻出用語であったりするとやや時間がかかってしまいます。

そのようなケースでは、**フィルタ** 機能を利用して、原文に特定のテキストを含む部分のみを対訳表としてエクスポートできます。

この機能を利用するには、「原文のテキストで検索」と同様に操作をしたのち、**「抽出実行」**ボタンを押します。
確認用のダイアログが表示された後、新規Wordファイルに該当テキストを持つ原文と、その訳文が一覧表示されます。

### すべての原文をコンテンツコントロールへ変換

ここまで、コンテンツコントロールを利用した翻訳は、基本的に「対訳エディタ」を使用していました。
もし「対訳エディタ」を使用せずに「原文表示」のみで作業したい場合などは、最初にすべての原文をコンテンツコントロールに変換することで、対訳表エクスポートなどの機能を利用することができるようになります。

すべての原文をコンテンツコントロールへ変換するには、CATOVISタブのうち、**Set** のブロックにある **BiCC** ボタンを押します。
すると、すべての原文が文ごとにコンテンツコントロールへと変換されます。このコンテンツコントロールは表示されているオリジナルのテキストのほか、内部に同じ原文を持っているため、直接上書きしていくことで、最終的に「対訳エディタ」を利用した際と同じファイルを作成することができます。

### 機械翻訳への一括変換

すべての原文をコンテンツコントロールに入れることで、原文と訳文が一対一になる一括機械翻訳も実行できます。

この機能を使用するには、CATOVISタブのうち、**Machine Translations** のブロックにある **Auto MT** ボタンを押します。
確認のダイアログが表示された後、Googleの機械翻訳ですべての原文が置換されます。

事前に原文をコンテンツコントロールに入れていることで、後に対訳集としてエクスポートできるほか、元の書式もある程度保持することが可能となっています。

### コンテンツコントロールの一括削除

翻訳が終わったら、コンテンツコントロールをすべて削除し、訳文のみの状態にする必要があります。

すべてのコンテンツコントロールを削除するには、CATOVISタブのうち、**Set** のブロックにある **Clean** ボタンを押します。

するとすべてのコンテンツコントロールが削除され、訳文だけが残ります。

### コンテンツコントロールの中身を見るには

コンテンツコントロールの中身を実際に確認したい場合は、Wordのリボンメニューに **「開発タブ」** を表示させる必要があります。

リボンメニュー上で右クリックをして、 **リボンのユーザー設定** をクリックします。
右側の一覧のうち、 **開発** にチェックを入れることで、開発タブがリボンメニューに表示されます。

次に、中身を見たいコンテンツコントロールにカーソルを合わせ、**コントロール** の **プロパティ** をクリックすることで、直接原文を見たり編集したりすることができます。

## 特殊な一括置換

上書き翻訳を行っていると、用語の一括置換をすることも多いのではないでしょうか。

しかし用語の一括置換にはデメリットも伴います。

Word上で一括置換をしてしまうと、もちろん原文が書き変わってしまいます。
そのような原文・訳文言語が半々に入り混じったテキストでは、いざ機械翻訳をしようとしても上手くいきません。
また、誤った置換により意味が分からなくなることも少なくないでしょう。

**CATOVIS** はWordで上書き翻訳を行うにあたって、特殊な一括置換機能を備えています。

### 色付き置換

**CATOVIS** の用語置換を行うには、CATOVISタブのうち**Terms** のブロックにある **Replace Term** ボタンを押します。
すると、**Term Controller** が表示されます。この**Term Controller**の検索用語・置換用語のテキストボックスには、呼び出した際に選択していたテキストから一定の単語を抜き出して候補に入っています。
このなかから一つを選ぶか、自分で任意のテキストを入力をして **Replace** を押すと、一括置換が実行されます。

このとき、置換された用語は **赤** のフォントで表示されます。

### 置換の色を変更

次に、設定フォームを呼び出します。**Font** のタブの**Color** のうち、どれか一つを選んで **CONFIRM** を押すと、置換後の色を変更することができます。
なお、**None** を選択すると、色の変更を行わなくなります。

### タグ付きの置換

前述の「色付き置換」は、どこが置き換わったのかが分かるようになっていますが、原文自体は残っていません。

**CATOVIS** ではより強力な置換方法として、特殊な **CATOVISタグ** を使用した置換も実行できます。

**CATOVISタグ**とは、次のような形で表現される文字列のことです。

```
_@λ_検索用語->置換用語_λ@_
```

検索用語も残したまま置換しているのがポイントです。**CATOVISタグ** を含んだテキストを **CATOVIS** で処理する際には、これが適宜次のように処理されます。

- 原文表示フォームには、検索用語のみ表示
- 対訳エディタには、原文側に検索用語、訳文側に置換用語として表示
- 機械翻訳フォームには、検索用語のみ表示

こうすることで、置換した用語が問題なければそのまま使用し、誤っている場合も即座に原文を参照できる仕組みとなっています。

#### タグの削除

上記のうち、原文表示フォームを使用しているケースでは、肝心のWordファイル上でタグが残ったままとなっています。
この部分について、置換が問題ない場合は **Alt+Z** を押すことで、選択範囲内の**CATOVISタグ**付きのテキストをすべて **置換用語** のみに変換することができます。

また反対に、元の原文用語に戻したいときは **Ctrl+Alt+Z** を押してください。

::: tip

最初にすべてコンテンツコントロールに入れてから翻訳を始めている場合は、**CATOVISタグ**を利用しなくても元の原文を取得することができます。

:::

## 同一センテンスの自動伝播、一括QAなどの作業自動化支援

この機能は現在、鋭意開発中です。
公開をお待ちください。
